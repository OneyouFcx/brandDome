<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.icei.mapper.BrandMapper">
  <resultMap id="BaseResultMap" type="com.icei.domain.Brand">
    <id column="brand_id" jdbcType="INTEGER" property="brandId" />
    <result column="brand_name" jdbcType="VARCHAR" property="brandName" />
    <result column="icon_path" jdbcType="VARCHAR" property="iconPath" />
    <result column="brand_desc" jdbcType="VARCHAR" property="brandDesc" />
    <result column="goods_num" jdbcType="INTEGER" property="goodsNum" />
    <result column="goods_quality" jdbcType="REAL" property="goodsQuality" />
    <result column="server_attitude" jdbcType="REAL" property="serverAttitude" />
    <result column="like_count" jdbcType="INTEGER" property="likeCount" />
    <result column="brand_title" jdbcType="VARCHAR" property="brandTitle" />
    <result column="brand_status" jdbcType="INTEGER" property="brandStatus" />
    <association property="brandPrincipal" javaType="com.icei.domain.BrandPrincipal">
        <id column="audit_id" jdbcType="INTEGER" property="auditId" />
	    <result column="audit_name" jdbcType="VARCHAR" property="auditName" />
	    <result column="audit_tel" jdbcType="VARCHAR" property="auditTel" />
	    <result column="audit_address" jdbcType="VARCHAR" property="auditAddress" />
	    <result column="audit_idCad" jdbcType="BIGINT" property="auditIdcad" />
	    <result column="audit_idCad_ImgFront" jdbcType="VARCHAR" property="auditIdcadImgfront" />
	    <result column="audit_idCad_ImgBack" jdbcType="VARCHAR" property="auditIdcadImgback" />
    </association>
  </resultMap>

  <sql id="Base_Column_List">
    brand_id, brand_name, icon_path, brand_desc, goods_num, goods_quality, server_attitude, 
    like_count, brand_title, brand_status
  </sql>
  <!-- 个人中心关注店铺 -->
  <select id="getUserLikeBrand" resultType="java.lang.Integer" resultMap="BaseResultMap">
  	select b.brand_id,b.brand_name,b.icon_path from user_detail u,like_brand l, brand b
	where u.user_id=l.user_id and b.brand_id=l.brand_id and u.user_id=#{userId}
  </select>
  
  <!--全部店铺-->
  <select id="getBrandAll"  resultMap="BaseResultMap">
    select <include refid="Base_Column_List" /> from brand
  </select>
  <!-- 分页查询店铺信息 -->
  <select id="selectAllMessage"  resultMap="BaseResultMap">
    select * from brand br
    join brand_admin ba on ba.brand_id=br.brand_id
    join brand_principal bp on ba.principal_id=bp.audit_id
    where 1=1
    <if test="id!=0">
      and br.brand_id=#{id}
    </if>
    <if test="nametype!=''">
      and br.brand_name like concat('%',#{nametype},'%')
    </if>
    limit #{page},#{end}
  </select>
  <!-- 查询总条数 -->
  <select id="selectByidCount" resultType="java.lang.Integer">
    select count(*) from brand br
    join brand_admin ba on ba.brand_id=br.brand_id
    join brand_principal bp on ba.principal_id=bp.audit_id
    <if test="id!=0">
      and br.brand_id=#{id}
    </if>
    <if test="nametype!=''">
      and br.brand_name like concat('%',#{nametype},'%')
    </if>
  </select>
  <!-- 修改店铺的状态正常/封停 -->
  <update id="updateByStatus" parameterType="java.lang.Integer">
    update brand set
    <if test="num==0">
      brand_status=1
    </if>
    <if test="num==1">
      brand_status=0
    </if>
    where brand_id=#{id}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 19 10:27:54 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from brand
    where brand_id = #{brandId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 19 10:27:54 CST 2018.
    -->
    delete from brand
    where brand_id = #{brandId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.icei.domain.Brand">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 19 10:27:54 CST 2018.
    -->
    insert into brand (brand_id, brand_name, icon_path, 
      brand_desc, goods_num, goods_quality, 
      server_attitude, like_count, brand_title, 
      brand_status)
    values (#{brandId,jdbcType=INTEGER}, #{brandName,jdbcType=VARCHAR}, #{iconPath,jdbcType=VARCHAR}, 
      #{brandDesc,jdbcType=VARCHAR}, #{goodsNum,jdbcType=INTEGER}, #{goodsQuality,jdbcType=REAL}, 
      #{serverAttitude,jdbcType=REAL}, #{likeCount,jdbcType=INTEGER}, #{brandTitle,jdbcType=VARCHAR}, 
      #{brandStatus,jdbcType=INTEGER})
  </insert>
  <!-- 插入返回主键 -->
  <insert id="insertSelective" useGeneratedKeys="true" keyProperty="brandId" keyColumn="brand_id" parameterType="com.icei.domain.Brand">
    insert into brand
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="brandId != null">
        brand_id,
      </if>
      <if test="brandName != null">
        brand_name,
      </if>
      <if test="iconPath != null">
        icon_path,
      </if>
      <if test="brandDesc != null">
        brand_desc,
      </if>
      <if test="goodsNum != null">
        goods_num,
      </if>
      <if test="goodsQuality != null">
        goods_quality,
      </if>
      <if test="serverAttitude != null">
        server_attitude,
      </if>
      <if test="likeCount != null">
        like_count,
      </if>
      <if test="brandTitle != null">
        brand_title,
      </if>
      <if test="brandStatus != null">
        brand_status,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="brandId != null">
        #{brandId,jdbcType=INTEGER},
      </if>
      <if test="brandName != null">
        #{brandName,jdbcType=VARCHAR},
      </if>
      <if test="iconPath != null">
        #{iconPath,jdbcType=VARCHAR},
      </if>
      <if test="brandDesc != null">
        #{brandDesc,jdbcType=VARCHAR},
      </if>
      <if test="goodsNum != null">
        #{goodsNum,jdbcType=INTEGER},
      </if>
      <if test="goodsQuality != null">
        #{goodsQuality,jdbcType=REAL},
      </if>
      <if test="serverAttitude != null">
        #{serverAttitude,jdbcType=REAL},
      </if>
      <if test="likeCount != null">
        #{likeCount,jdbcType=INTEGER},
      </if>
      <if test="brandTitle != null">
        #{brandTitle,jdbcType=VARCHAR},
      </if>
      <if test="brandStatus != null">
        #{brandStatus,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.icei.domain.Brand">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 19 10:27:54 CST 2018.
    -->
    update brand
    <set>
      <if test="brandName != null">
        brand_name = #{brandName,jdbcType=VARCHAR},
      </if>
      <if test="iconPath != null">
        icon_path = #{iconPath,jdbcType=VARCHAR},
      </if>
      <if test="brandDesc != null">
        brand_desc = #{brandDesc,jdbcType=VARCHAR},
      </if>
      <if test="goodsNum != null">
        goods_num = #{goodsNum,jdbcType=INTEGER},
      </if>
      <if test="goodsQuality != null">
        goods_quality = #{goodsQuality,jdbcType=REAL},
      </if>
      <if test="serverAttitude != null">
        server_attitude = #{serverAttitude,jdbcType=REAL},
      </if>
      <if test="likeCount != null">
        like_count = #{likeCount,jdbcType=INTEGER},
      </if>
      <if test="brandTitle != null">
        brand_title = #{brandTitle,jdbcType=VARCHAR},
      </if>
      <if test="brandStatus != null">
        brand_status = #{brandStatus,jdbcType=INTEGER},
      </if>
    </set>
    where brand_id = #{brandId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.icei.domain.Brand">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 19 10:27:54 CST 2018.
    -->
    update brand
    set brand_name = #{brandName,jdbcType=VARCHAR},
      icon_path = #{iconPath,jdbcType=VARCHAR},
      brand_desc = #{brandDesc,jdbcType=VARCHAR},
      goods_num = #{goodsNum,jdbcType=INTEGER},
      goods_quality = #{goodsQuality,jdbcType=REAL},
      server_attitude = #{serverAttitude,jdbcType=REAL},
      like_count = #{likeCount,jdbcType=INTEGER},
      brand_title = #{brandTitle,jdbcType=VARCHAR},
      brand_status = #{brandStatus,jdbcType=INTEGER}
    where brand_id = #{brandId,jdbcType=INTEGER}
  </update>
</mapper>