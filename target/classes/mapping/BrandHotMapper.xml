<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.icei.mapper.BrandHotMapper">
  <resultMap id="BaseResultMap" type="com.icei.domain.BrandHot">
    <id column="hot_id" jdbcType="INTEGER" property="hotId" />
    <result column="brand_id" jdbcType="INTEGER" property="brandId" />
    <result column="goods_id" jdbcType="INTEGER" property="goodsId" />
    <association resultMap="goods" property="goods"></association>
  </resultMap>
  <!--商品-->
  <resultMap id="goods" type="com.icei.domain.BrandGoods">
    <id column="goods_id" jdbcType="INTEGER" property="goodsId" />
    <result column="brand_id" jdbcType="INTEGER" property="brandId" />
    <result column="goods_name" jdbcType="VARCHAR" property="goodsName" />
    <result column="type_detail_id" jdbcType="INTEGER" property="typeDetailId" />
    <result column="goods_price" jdbcType="REAL" property="goodsPrice" />
    <result column="goods_discount" jdbcType="REAL" property="goodsDiscount" />
    <result column="diy_price" jdbcType="REAL" property="diyPrice" />
    <result column="is_diy" jdbcType="INTEGER" property="isDiy" />
    <result column="production_cycle" jdbcType="INTEGER" property="productionCycle" />
    <result column="goods_dec" jdbcType="VARCHAR" property="goodsDec" />
    <result column="materials" jdbcType="VARCHAR" property="materials" />
    <result column="sales_volume" jdbcType="INTEGER" property="salesVolume" />
    <result column="goods_quality" jdbcType="REAL" property="goodsQuality" />
    <result column="server_attitude" jdbcType="REAL" property="serverAttitude" />
    <result column="assess_count_love" jdbcType="INTEGER" property="assessCountLove" />
    <result column="assess_count" jdbcType="INTEGER" property="assessCount" />
    <result column="like_count" jdbcType="INTEGER" property="likeCount" />
    <result column="goods_img" jdbcType="VARCHAR" property="goodsImg" />
    <result column="diy_back" jdbcType="VARCHAR" property="diyBack" />
    <!-- 商品图片映射 -->
    <association resultMap="GoodsMedia" property="goodsMedia"></association>
    <!-- 以获取商品一张图片映射 -->
    <association resultMap="GoodsMedia" property="goodsMediaOne"></association>
  </resultMap>
  <!-- 商品图片映射 -->
  <resultMap id="GoodsMedia" type="com.icei.domain.GoodsMedia">
    <id column="intro_id" jdbcType="INTEGER" property="introId" />
    <result column="goods_id" jdbcType="INTEGER" property="goodsId" />
    <result column="intro_type" jdbcType="VARCHAR" property="introType" />
    <result column="intro_path" jdbcType="VARCHAR" property="introPath" />
  </resultMap>
  <sql id="Base_Column_List">
    bh.hot_id, bh.brand_id, bh.goods_id
  </sql>
  
  <select id="selectBygoodsid" resultType="java.lang.Integer">
  		select count(1) from brand_hot where goods_id=#{goodsid}
  </select>
  <!--商品-->
  <sql id="goodssql">
    bg.goods_id, bg.brand_id, bg.goods_name, bg.type_detail_id, bg.goods_price, bg.goods_discount, bg.diy_price,
    bg.is_diy, bg.production_cycle, bg.goods_dec, bg.materials, bg.sales_volume, bg.goods_quality, bg.server_attitude,
    assess_count_love, assess_count, like_count,goods_img
  </sql>
  <!--商品图片-->
  <sql id="goodsmediasql">
    gm.intro_id, gm.goods_id, gm.intro_type, gm.intro_path
  </sql>
	
<select id="getAllmsg"  resultMap="BaseResultMap">
	select * from brand_hot bh
	inner join brand_goods bg on  bh.goods_id=bg.goods_id
	where 1=1
	<if test="hotid!=0">
		and hot_id=#{hotid}
	</if>
	limit #{page},#{limit}
</select>	

	<select id="getAllmsgCount"  resultType="java.lang.Integer">
	select count(*) from brand_hot bh
	inner join brand_goods bg on  bh.goods_id=bg.goods_id
	where 1=1
	<if test="hotid!=0">
		and hot_id=#{hotid}
	</if>
	</select>
	
  <!--查询店铺推荐商品-->
  <select id="getBrandHotAll" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />,
    <include refid="goodssql" />
    from brand_hot as bh,brand_goods as bg
    where bh.goods_id=bg.goods_id
    and bh.brand_id = #{brandId,jdbcType=INTEGER}
  </select>

  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 19 10:27:54 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from brand_hot
    where hot_id = #{hotId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 19 10:27:54 CST 2018.
    -->
    delete from brand_hot
    where hot_id = #{hotId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.icei.domain.BrandHot">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 19 10:27:54 CST 2018.
    -->
    insert into brand_hot (hot_id, brand_id, goods_id
      )
    values (#{hotId,jdbcType=INTEGER}, #{brandId,jdbcType=INTEGER}, #{goodsId,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.icei.domain.BrandHot">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 19 10:27:54 CST 2018.
    -->
    insert into brand_hot
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="hotId != null">
        hot_id,
      </if>
      <if test="brandId != null">
        brand_id,
      </if>
      <if test="goodsId != null">
        goods_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="hotId != null">
        #{hotId,jdbcType=INTEGER},
      </if>
      <if test="brandId != null">
        #{brandId,jdbcType=INTEGER},
      </if>
      <if test="goodsId != null">
        #{goodsId,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.icei.domain.BrandHot">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 19 10:27:54 CST 2018.
    -->
    update brand_hot
    <set>
      <if test="brandId != null">
        brand_id = #{brandId,jdbcType=INTEGER},
      </if>
      <if test="goodsId != null">
        goods_id = #{goodsId,jdbcType=INTEGER},
      </if>
    </set>
    where hot_id = #{hotId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.icei.domain.BrandHot">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Apr 19 10:27:54 CST 2018.
    -->
    update brand_hot
    set brand_id = #{brandId,jdbcType=INTEGER},
      goods_id = #{goodsId,jdbcType=INTEGER}
    where hot_id = #{hotId,jdbcType=INTEGER}
  </update>
</mapper>