<!DOCTYPE html><html><head>    <meta charset="utf-8">    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">    <link rel="stylesheet" href="style.css">    <script src="/icei/js/diydz/hammer.min.js"></script>    <title>Hammer.js</title>    <style>        html, body {            overflow: hidden;            margin: 0;        }        body {            -webkit-perspective: 500;            -moz-perspective: 500;            perspective: 500;        }        .animate {            -webkit-transition: all .3s;            -moz-transition: all .3s;            transition: all .3s;        }        #hit {            padding: 10px;        }    </style></head><body>    <div id="hit" style="background: #42d692; width: 150px; height: 150px;"></div>    <script>        var reqAnimationFrame = (function () {            return window[Hammer.prefixed(window, 'requestAnimationFrame')] || function (callback) {                window.setTimeout(callback, 1000 / 60);            };        })();        var el = document.querySelector("#hit");        var START_X = Math.round((window.innerWidth - el.offsetWidth) / 2);        var START_Y = Math.round((window.innerHeight - el.offsetHeight) / 2);        var ticking = false;        var transform;        var timer;        var mc = new Hammer.Manager(el);        mc .get("rotate").set({ enable: true });//开启旋转、缩放、垂直移动        mc.add(new Hammer.Pan({threshold: 0, pointers: 0}));        mc.add(new Hammer.Swipe()).recognizeWith(mc.get('pan'));        mc.add(new Hammer.Rotate({threshold: 0})).recognizeWith(mc.get('pan'));        mc.add(new Hammer.Pinch({threshold: 0})).recognizeWith([mc.get('pan'), mc.get('rotate')]);        mc.add(new Hammer.Tap({event: 'doubletap', taps: 2}));        mc.add(new Hammer.Tap());        mc.on("panstart panmove", onPan);//拖动开始+拖动过程        mc.on("rotatestart rotatemove", onRotate);//旋转开始+旋转过程        mc.on("pinchstart pinchmove", onPinch);//多点触控开始+多点触控过程        //mc.on("swipe", onSwipe);//一个手指在屏幕上滑动，即滑动事件。该事件对以下事件进行监听：        //mc.on("tap", onTap);//在指定dom事件区域内，一个手指轻拍或点击时触发该事件(类似PC端的click)        // mc.on("doubletap", onDoubleTap);//双击        mc.on("hammer.input", function (ev) {            if (ev.isFinal) {                resetElement();            }        });        function resetElement() {            el.className = 'animate';            transform = {                translate: {x: START_X, y: START_Y},                scale: 1,                angle: 0,                rx: 0,                ry: 0,                rz: 0            };            requestElementUpdate();        }        function updateElementTransform() {            var value = [                'translate3d(' + transform.translate.x + 'px, ' + transform.translate.y + 'px, 0)',                'scale(' + transform.scale + ', ' + transform.scale + ')',                'rotate3d(' + transform.rx + ',' + transform.ry + ',' + transform.rz + ',' + transform.angle + 'deg)'            ];            value = value.join(" ");            el.textContent = value;            el.style.webkitTransform = value;            el.style.mozTransform = value;            el.style.transform = value;            ticking = false;        }        function requestElementUpdate() {            if (!ticking) {                reqAnimationFrame(updateElementTransform);                ticking = true;            }        }        function onPan(ev) {            el.className = '';            transform.translate = {                x: START_X + ev.deltaX,                y: START_Y + ev.deltaY            };            requestElementUpdate();        }        var initScale = 1;        function onPinch(ev) {            if (ev.type == 'pinchstart') {                initScale = transform.scale || 1;            }            el.className = '';            transform.scale = initScale * ev.scale;            requestElementUpdate();        }        var initAngle = 0;        function onRotate(ev) {            console.log("旋转")            console.log(ev.rotation)            if (ev.type == 'rotatestart') {                initAngle = transform.angle || 0;            }            el.className = '';            transform.rz = 1;            transform.angle = initAngle + ev.rotation;            requestElementUpdate();        }        function onSwipe(ev) {            var angle = 50;            transform.ry = (ev.direction & Hammer.DIRECTION_HORIZONTAL) ? 1 : 0;            transform.rx = (ev.direction & Hammer.DIRECTION_VERTICAL) ? 1 : 0;            transform.angle = (ev.direction & (Hammer.DIRECTION_RIGHT | Hammer.DIRECTION_UP)) ? angle : -angle;            clearTimeout(timer);            timer = setTimeout(function () {                resetElement();            }, 300);            requestElementUpdate();        }        function onTap(ev) {            transform.rx = 1;            transform.angle = 25;            clearTimeout(timer);            timer = setTimeout(function () {                resetElement();            }, 200);            requestElementUpdate();        }        function onDoubleTap(ev) {            transform.rx = 1;            transform.angle = 80;            clearTimeout(timer);            timer = setTimeout(function () {                resetElement();            }, 500);            requestElementUpdate();        }        resetElement();    </script></body></html>