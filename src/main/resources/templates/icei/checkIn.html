<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>SPOONS-CheckIn</title>
	<link href="/icei/css/activity/checkIn.css" rel="stylesheet" type="text/css"><!--Register-->
	<link href="/icei/css/Public.css" rel="stylesheet" type="text/css"><!--Public-->
	<link rel="stylesheet" href="/icei/css/top.css">
	<link rel="stylesheet" href="https://at.alicdn.com/t/font_612454_wr0yqv5p80s2x1or.css">
	<link rel="stylesheet" href="http://spoons.test.upcdn.net/layui/css/layui.css">
	<link rel="stylesheet" href="/icei/css/activity/InData.css">

	<script src="/icei/js/jquery-3.2.1.min.js"></script>
	<script src="http://spoons.test.upcdn.net/layui/layui.all.js"></script>
	<script src="/icei/js/jquery.nicescroll.min.js"></script>
	<script type="text/javascript" src="/icei/js/activity/ImgYunTop.js"></script>
	<style>
		html,body{
			width: 100%;
		}
		@media(max-width:960px){
			.shadowrect{
				display: none;
		}	
		#switcher>.center_table{
			display:none;
		}
	</style>
</head>
<body>
	<!--header-->
	<header class="c-header">
		<div class="wow fadeInLeft c-logo"><a href="/icei/"><img src="/icei/img/logo/logo.png"></a></div>
		<nav>
			<div class="wow fadeInRight c-main-nav">
				<ul>
					<li><a href="https://www.baidu.com/" class="o-link">登录</a></li>
					<li><a class="o-link">注册</a></li>
				</ul>
			</div>
		</nav>
	</header>
	<!--headerEnd-->
	<!--head-->
	<section class="container head">
		<div class="logo"></div>
		<div class="backg"></div>
		<div class="backg_white"></div>
		<div class="shadowrect head_shadowrect"></div>
		<!--入驻信息-->
		<div class="head-info">
			<div class="head-recruit">
				<div class="head-head">
					SPOONS旺铺招募计划
				</div>
				<div class="head-hot">
					旺铺火热集结中
				</div>
				<div class="head-introduce">
					SPOONS定制——个性生活，记录生活点滴<br>
					<br>
					快来SPOONS加入店铺计划，提高盈利、创业绩、最新营销活动等
					,店铺强势入驻,成为长久合作伙伴！
				</div>
				<div class="head-end">
					<a>成为老板</a>
				</div>
				<div class="head-img">	
					<img src="/icei/img/activity/enter.jpg" alt="">
				</div>
			</div>
		</div>
		<!--入驻信息END-->
	</section>
	<!--head End-->
	<!--Main入驻标准-->
	<main class="container main">
		<!--内容-->
		<section class="test">
			<div class="test-head">
				合作方式灵活多样，成功之道就在脚下
			</div>
			<div class="test-sign">
				<img src="img/activity/v.jpg" alt="">
				入驻通过审核可成为平台合作商家实现双赢 
			</div>
			<div class="test-ul">
				<ul>
					<li><i class="iconfont icon-duihao"></i>Let me look at you again.</li>
					<li><i class="iconfont icon-duihao"></i>from south to north.</li>
					<li><i class="iconfont icon-duihao"></i>I'll give you 99 roses.</li>
					<li><i class="iconfont icon-duihao"></i>To be alone is the fate of all great minds.</li>
					<li><i class="iconfont icon-duihao"></i>for then better days</li>
				</ul>
				<div>
					<img src="/icei/img/activity/super.png" alt="">
				</div>
			</div>
			<!--店铺展示-->
				<div class="test_title">
					精选店铺模板展示，更多店铺等你来创造
				</div>
				<div class="join_img">
					<img src="/icei/img/activity/brand.jpg" alt="">
				</div>
			<!--店铺展示END-->
		</section>
		<!--内容End-->
		<!--底部衔接-->
		<section class="join_bom">
			<div class="backg_bom"></div>
			<div class="backg_bom1"></div>
		</section>
		<!--底部衔接 End-->
		<!--悬浮盒子-->
		<div class="shadowrect main_box_left"></div>
		<div class="shadowrect main_box_right"></div>
		<div class="shadowrect main_box_bom"></div>
		<!--悬浮盒子 End-->
	</main>
	<!--Main 入驻标准End-->
	<!--foot-->
	<footer class="container foot">
		<div class="shadowrect foot_box_left"></div>
		<div class="shadowrect foot_box_right"></div>
		<!--提交合作-->
		<div class="foot_apply">
			<h2>了解合作流程，顺利成为SPOONS平台商家</h2>
			<!--线-->
			<hr class="xian"></hr>
			<ul>
				<span></span><li>注册并填写店铺信息完成店铺认证</li>
				<span></span><li>根据SPOONS需求及规范完成店铺设计</li>
				<span></span><li>在店铺后台提交店铺及店铺信息</li>
				<span></span><li>SPOONS将在两个工作日内快速审核并反馈</li>
				<span></span><li>在店铺后台上传宝贝，审核通过后盈利获得收益</li>
				<span></span><li>SPOONS团队提供全面支持</li>
			</ul>
			<div class="foot-end" >
				成为老板
			</div>
			<div class="foot_img">
				<span> <img src="/icei/img/activity/earnings.png" alt="">入驻须知</span>
				<span><img src="/icei/img/activity/applyTime.png" alt="">审核标准/时间</span>
				<span> <img src="/icei/img/activity/apply.png" alt="">定价方案</span>
				<span><img src="/icei/img/activity/money.png" alt="">收益结算</span>
			</div>
			<div class="foot_text">
				<p>了解最新资讯和动态，请添加SPOONS微信公众号：冰淇淋小屋
									或添加SPOONS店铺交流QQ群：********</p>
				<div class="foot_code">
					<img src="/icei/img/activity/SPOONS.jpg" alt="">
					【扫码更快】
				</div>
			</div>
		</div>
		<!--提交合作END-->
	</footer>
	<!--foot End-->
</body>
<div id="only" style="display: none;">
	<form>
		<table class="top_table">
			<tr>
				<td class="key">真实姓名</td>
				<td class="val"><input type="text" placeholder="请填写真实姓名" name="auditName" onblur="checkName()"></td>
			</tr>
			<tr>
				<td class="key">联系人地址</td>
				<td class="val"><input type="text" placeholder="请填写真实地址" name="auditAddress" onblur="checkAddress()"></td>
			</tr>
			<tr>
				<td class="key">手机号</td>
				<td class="val"><input type="text" name="auditTel" onblur="checkTel()" id="phone"></td>
			</tr>
			<tr>
				<td class="key"></td>
				<td class="val new_val" style="display: none"><input id="serial" type="text" placeholder="请输入验证码" name="tel_verify" onblur="checkTelVerify()"><a href="javascript:" id="getCode" class="std-btn">获取验证码</a></td>
			</tr>
		</table>
		<table class="centre_table">
			<tr>
				<td class="key">店铺名称</td>
				<td class="val"><input type="text" placeholder="Please fill in the name of the shop" name="brandName" onblur="checkBrandName()"></td>
			</tr>
			<tr>
				<td class="key">店铺简介</td>
				<td class="val"><input type="text" placeholder="" name="brandIntro" onblur="checkbrandIntro()"></td>
			</tr>
			<tr>
				<td class="key new_key">店铺logo</td>
				<td class="val val_new">
					<div class="file">
					<input type="file" name="typeImg" id="upload" style="display:none;">
						<i class="iconfont icon-shangchuan1"></i>
						<a id="Aupload">上传照片</a>
						<img src="" />
					</div>
				</td>
			</tr>
		</table>
		<table class="bottom_table">
			<tr>
				<td class="key">有效证件号码</td>
				<td class="val"><input type="text" placeholder="请输入身份证号码" name="auditIdCad" onblur="checkauditIdCad()"></td>
			</tr>
			<tr>
				<td class="key new_key">有效证件照片</td>
				<td class="val val_new">
					<div class="file">
						<input type="file" name="typeImg" id="upload1" style="display:none;">
						<i class="iconfont icon-shangchuan1"></i>
						<a id="Aupload1">上传照片</a>
						<img src="" />
					</div>
					<div class="file">
						<input type="file" name="typeImg" id="upload2" style="display:none;">
						<i class="iconfont icon-shangchuan1"></i>
						<a id="Aupload2">上传照片2</a>
						<img src="" />
					</div>
				</td>
			</tr>
		</table>
		<!-- 审核查询 -->
		<div id="switcher">
			<table class="top_table">
				<tr>
					<td class="key">回执编码</td>
					<td class="val"><input type="text" id="selectid"></td>
				</tr>
				<tr>
					<td class="key">手机号</td>
					<td class="val"><input type="text" id="selectphone"></td>
				</tr>
			</table>
			<table class="centre_table" style="border:none">
				<tr>
					<td class="key">注册账号</td>
					<td class="val"><input type="text" name="number" onblur="checknumber()"></td>
				</tr>
				<tr>
					<td class="key">密码</td>
					<td class="val"><input type="password" name="password"></td>
				</tr>
				<tr>
					<td class="key">确认密码</td>
					<td class="val"><input type="password" name="repassword"></td>
				</tr>
			</table>
			<div class="present1">提交</div>
		</div>
		<div class="present">提交</div>
	</form>
	<div class="switcher">审核查询</div>	
</div>
<script type="text/javascript" src="/icei/js/activity/CheckInValidation.js"></script>
<script type="text/javascript">
//注册追加结束
$(function(){
    $(function(){
        $("body").niceScroll({
            cursorcolor: "#000",
            cursoropacitymax: 0.2,
        });
    });
 	/*审核查询切换*/
    $(".switcher").click(function(){
    	if($(".switcher").text()=='审核查询'){
    		$("form>table").hide('slow');
    		$(".present").hide('slow');
    		$(".switcher").text('返回')
    		$("#switcher").show('slow');
    		$("#switcher>.centre_table").hide();
    	}else{
    		$(".switcher").text('审核查询')
    		$("form>table").show('slow');
    		$(".present").show('slow');
    		$("#switcher").hide('slow');
    		$(".present1").text('提交');
    		$("#switcher").animate({marginTop:"0px"});//位置恢复
    		$("#switcher>.present1").animate({top:"100px"},1000);//位置恢复
    	}
    })
    $('.foot-end').click(function () {
        $(".head-end").click();
    })
    $(".head-end").click(function(){
        //自定页
        layer.open({
            title:'店铺强势入驻',
            type: 1,
            fixed:true,
            skin: 'layui-layer-demo', //样式类名
            closeBtn: 0, //不显示关闭按钮
            anim: 2,
            shadeClose: true, //开启遮罩关闭
            scrollbar: false,
            content: $('#only'),
            area: ['1200px','740px'],
            success: function(layero, index){
                $("#only form").niceScroll();
            },
            end:function(){
            	$("#only").hide();
            }
        });
	})
	$("#Aupload").click(function(){
		 $("#upload").click();
	})
	$("#Aupload1").click(function(){
		$("#upload1").click();
	})
	$("#Aupload2").click(function(){
		$("#upload2").click();
	})
	$("#upload").click(function(){
		$(this).change(function(){
			$(this).FileChangeFn($("#upload"));
		});
	});
	$("#upload1").click(function(){
		$(this).change(function(){
			$(this).FileChangeFn($("#upload1"));
		});
	});
	$("#upload2").click(function(){
		$(this).change(function(){
			$(this).FileChangeFn($("#upload2"));
		});
	});
	/*点击提交表单*/
    $(".present").click(function(){
    	//非空判断
		if(checkInValidation()){
			if(checkTel()){
				if(checkTelVerify()){
					var	formData = new FormData();
					formData.append("brandName",$("input[name='brandName']").val());//店铺名称
					formData.append("brandIntro",$("input[name='brandIntro']").val());//店铺介绍
					formData.append("auditName",$("input[name='auditName']").val());//店铺负责人
					formData.append("auditTel",$("input[name='auditTel']").val());//手机号
					formData.append("auditAddress",$("input[name='auditAddress']").val());//地址
					formData.append("auditIdcad",$("input[name='auditIdCad']").val());//身份证
					formData.append("serial",$("input[name='tel_verify']").val());//验证码
				    formData.append('file', $('#upload')[0].files[0]);//店铺头像
				    formData.append('file', $('#upload1')[0].files[0]);//身份证正面
				    formData.append('file', $('#upload2')[0].files[0]);//身份证反面
					$(this).yunimg(formData);
				}
			}
		};
	})
    $("#phone").bind('input propertychange',function(){
    	if(!/^[1][3,4,5,7,8][0-9]{9}$/.test($(this).val())){
    		$(this).css("border"," 1px #f78983 solid");
    		$(".new_val").hide();
    	}else {
    		$(this).css("border"," 1px #e5e5e5 solid");
    		layer.msg('手机号正确');
    		$(".new_val").show();
		}
    })
    $('#selectphone').bind('input propertychange',function(){
    	if(!/^[1][3,4,5,7,8][0-9]{9}$/.test($(this).val())){
    		$(this).css("border"," 1px #f78983 solid");
    		$(".new_val").hide();
    	}else {
    		$(this).css("border"," 1px #e5e5e5 solid");
    		layer.msg('手机号正确');
    		$(".new_val").show();
		}
    })
    $("#serial").bind('input propertychange',function(){
    	checkTelVerify();//验证码
    })
	//短信验证码
	var wait=60;
	function time(o){
	    if (wait==0) {
	        o.removeAttribute("disabled");    
	        o.innerHTML="输入验证码";
	        o.style.backgroundColor="#fe9900";
	        wait=60;
	    }else{
	        o.setAttribute("disabled", "disabled");
	        $("#getCode").css("cursor","not-allowed");
	        o.innerHTML=wait+"秒后重新获取";
	        o.style.backgroundColor="#8f8b8b";
	        wait--;
	        $("#getCode").attr('onclick','').unbind('click');
	        setTimeout(function(){
	            time(o)
	        },1000)
	    }
	}
	$("#getCode").click(function(){	
		if(checkTel()){
			time(this);
			getMsg($("#phone").val());//获取验证码
		}
	});
	/*回执编号查询*/
	$(".present1").click(function(){
		getBrandAuditSerial($('#selectid').val(),$('#selectphone').val());
	})
})
//联系人手机号非空验证
function checkTel(){
	var auditTel=$("input[name='auditTel']").val();
	if(auditTel==''||auditTel==null){
		$("input[name='auditTel']").css("border"," 1px #f78983 solid");
		layer.msg('请输入手机号码');
		return false;
	}else if(!/^[1][3,4,5,7,8][0-9]{9}$/.test($("input[name='auditTel']").val())){
		$("input[name='auditTel']").css("border"," 1px #f78983 solid");
		layer.msg('请输入正确的手机号码');
		return false;
	}
	$("input[name='auditTel']").css("border"," 1px #e5e5e5 solid");
	return true;
}
//验证码非空验证
function checkTelVerify(){
	var phone=$("input[name='auditTel']").val(),
		serial=$("input[name='tel_verify']").val();
	if(serial.length!=6){
		$("input[name='tel_verify']").css("border"," 1px #f78983 solid");
		layer.msg('验证码少于6位');
		return false;
	}else if(!verifyMsg(phone,serial)){
		$("input[name='tel_verify']").css("border"," 1px #f78983 solid");
		return false;
	}
	$("input[name='tel_verify']").css("border"," 1px #e5e5e5 solid");
	return true;
}
/*验证码检查*/
function verifyMsg(phone,serial){
	var ft=true;
	$.ajax({
        type: "get",
        url: "/icei/verifyMsg",
        data: {phone:phone,serial:serial},
        dataType:"json",
        async: false,
        success: function(res) {
        	if(res.code==0){
        		layer.msg('验证码正确');
        	}else{
        		layer.msg(res.msg);
        		ft=false;
        	}
        }
    });
	return ft;
}
/*获取验证码*/
function getMsg(phone){
	$.ajax({
       	type: "GET",
        url: "/icei/getMsmBrandAudit",
        data: {phone:phone},
        dataType:"json",
        success: function(res) {
        	console.log(res.code);
        	if(res.code==0){
        		layer.msg('验证码获取成功');
        	}else{
        		layer.msg(res.msg);
			}
        }
    });
}
/*查询是否通过*/
function getBrandAuditSerial(serial,phone){
	$.ajax({
       	type: "GET",
        url: "/icei/getBrandAuditSerial",
        data: {serial:serial,phone:phone},
        dataType:"json",
        success: function(res) {
        	console.log(res.code);
        	if(res.code==0,res.data!=null){
        		layer.alert(res.data.statusName, {icon: 6});
        		if(res.data.auditStatusId==1){
        			$(".present1").unbind();//解除绑定单击事件
        			//动画
            		$("#switcher").animate({marginTop:"100px"},1000);//位置下移
            		$("#switcher>.present1").animate({top:"280px"},1000);//位置下移
            		$("#switcher>.centre_table").show(1000);//输入框显示
            		$(".present1").text('注册');
            		//注册验证
            		$(".present1").click(function(){
            			var serial=$("#selectid").val();
            			var phone=$("#selectphone").val();
            			var code=$("input[name='number']").val();
            			var pwd=$("input[name='password']").val();
            			$.ajax({
            				url:'/brand/login/addBrandAdmin',
            				data:{"serial":serial,"phone":phone,"code":code,"pwd":pwd},
            				type:'Post',
            				success:function(data){
            					if(data.code==0){
            						layer.msg("店铺账号注册成功,欢迎您.即将跳转登录···", {icon: 6},function(){
            							window.location="/brand/login/";
            						});
            					}else{
            						layer.msg("店铺账号注册失败,555····", {icon: 6});
            					}
            				}
            			})
            		})
            	//注册验证结束
        		}
        	}else if (res.data==null) {
        		layer.msg('没有查询到信息', {icon: 5});
     	
			}else if(res.code!=0){
        		layer.msg(res.msg, function(){});
			}
        }
    });
}
//账号正则验证
function checknumber(){
	var number=$("input[name='number']").val();//账号
	var reg = /^[a-zA-Z0-9]{4,16}$/;//用户名正则，4到16位（字母，数字）
	//ajax验证是否账号重复-追加
	if(reg.test(number)&&number!=''&&number!=null){
		checkReNumber(number);
	}
	else{
		$("input[name='number']").css("border","1px #f78983 solid");
		return false;
	}
}
//密码正则验证
function checkpassword(){
	var password=$("input[name='password']").val();//密码
	var reg = /^[a-zA-Z0-9]{4,16}$/;//密码正则，4到16位（字母，数字）
	if(reg.test(password)&&password!=''&&password!=null){
		$("input[name='password']").css("border"," 1px #e5e5e5 solid");
		return true;
	}else{
		$("input[name='password']").css("border"," 1px #f78983 solid");
		return false;
	}
}
//查询账号是否重复
function checkReNumber(number){
	var adminCode=number
	$.ajax({
		url:'/brand/login/getBrandAdminIs',
		data:{"adminCode":adminCode},
		type:'Get',
		success:function(data){
			if(data.code!=0){
				layer.msg('账号已被注册', {icon: 5});
				$("input[name='number']").css("border","1px #f78983 solid");
				return false;
			}else{
				layer.msg("账号可用", {icon: 6});
				$("input[name='number']").css("border","1px #e5e5e5 solid");
				return true;
			}
		}
	})
}
</script>
</html>
